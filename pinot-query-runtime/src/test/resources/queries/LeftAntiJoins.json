{
  "left_join_null_filter_test": {
    "tables": {
      "t1": {
        "schema": [
          {"name": "key_col", "type": "STRING"},
          {"name": "event_time", "type": "INT"}
        ],
        "inputs": [
          ["a", 1],
          ["b", 2],
          ["c", 3],
          ["d", 4],
          ["e", 5]
        ]
      },
      "t2": {
        "schema": [
          {"name": "key_col", "type": "STRING"},
          {"name": "event_time", "type": "INT"}
        ],
        "inputs": [
          ["b", 2],
          ["a", 1],
          ["c", 3],
          ["a", 2],
          ["c", 1],
          ["b", 3],
          ["d", 5]
        ]
      }
    },
    "queries": [
      {
        "sql": "SELECT {t1}.key_col, {t1}.event_time FROM {t1} LEFT JOIN {t2} ON {t1}.key_col = {t2}.key_col AND {t1}.event_time > {t2}.event_time WHERE {t2}.key_col IS NULL",
        "outputs": [
          ["a", 1],
          ["b", 2],
          ["d", 4],
          ["e", 5]
        ]
      },
      {
        "sql": "SELECT {t1}.key_col, {t1}.event_time FROM {t1} LEFT JOIN {t2} ON {t1}.key_col = {t2}.key_col AND {t1}.event_time >= {t2}.event_time WHERE {t2}.key_col IS NULL",
        "outputs": [
          ["d", 4],
          ["e", 5]
        ]
      },
      {
        "sql": "SELECT {t1}.key_col, {t1}.event_time FROM {t1} LEFT JOIN {t2} ON {t1}.key_col = {t2}.key_col AND {t1}.event_time < {t2}.event_time WHERE {t2}.key_col IS NULL",
        "outputs": [
          ["c", 3],
          ["e", 5]
        ]
      },
      {
        "sql": "SELECT {t1}.key_col, {t1}.event_time FROM {t1} LEFT JOIN {t2} ON {t1}.key_col = {t2}.key_col AND {t1}.event_time <= {t2}.event_time WHERE {t2}.key_col IS NULL",
        "outputs": [
          ["e", 5]
        ]
      }
    ]
  }
}
